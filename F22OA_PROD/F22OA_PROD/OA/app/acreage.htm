<html>
	<head>
		<title>面积换算</title>
		<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
		<link rel="stylesheet" type="text/css" href="../css/style.css">
		<SCRIPT language="JScript" type="text/JScript">
<!--

function AREA_MEASURES()              
{
  this.mSquare_kilometer = (1000 * 1000)
  this.mHectare = (100 * 100)
  this.mSquare_meter = 1
  this.mAre = ((10000/15) * this.mSquare_meter)
  this.mSquare_decimeter = (0.1 * 0.1)
  this.mSquare_centimeter = (0.01 * 0.01)
  this.mSquare_millimeter = (0.001 * 0.001)
  this.engSquare_foot = (0.3048 * 0.3048)
  this.engSquare_yard = (3 * 3 * this.engSquare_foot)
  this.usSquare_rod = (16.5 *16.5 * this.engSquare_foot)
  this.engAcre = 160 * this.usSquare_rod
  this.engSquare_mile = (5280 *5280 * this.engSquare_foot)
  this.engSquare_inch = (this.engSquare_foot / (12 * 12))
}

var area_data = new AREA_MEASURES();

function checkNum(str)
{
  for (var i=0; i<str.length; i++)
  {
    var ch = str.substring(i, i + 1)
    if (ch!="." && ch!="+" && ch!="-" && ch!="e" && ch!="E" && (ch < "0" || ch > "9"))
    {
      alert("请输入有效的数字");
      return false;
    }
  }
  return true
}

function normalize(what,digits)
{
  var str=""+what;
  var pp=Math.max(str.lastIndexOf("+"),str.lastIndexOf("-"));
  var idot=str.indexOf(".");

  if (idot>=1)
  {
    var ee=(pp>0)?str.substring(pp-1,str.length):"";
    digits+=idot;
    if (digits>=str.length)
      return str;
        if (pp>0 && digits>=pp)
      digits-=pp;
    var c=eval(str.charAt(digits));
    var ipos=digits-1;
    if (c>=5)
    {
      while (str.charAt(ipos)=="9")
        ipos--;
      if (str.charAt(ipos)==".")
      {
        var nc=eval(str.substring(0,idot))+1;
        if (nc==10 && ee.length>0)
        {
          nc=1;
          ee="e"+(eval(ee.substring(1,ee.length))+1);
        }
        return ""+nc+ee;
      }
      return str.substring(0,ipos)+(eval(str.charAt(ipos))+1)+ee;
    }
    else
      var ret=str.substring(0,digits)+ee;
    for (var i=0; i<ret.length; i++)
        if (ret.charAt(i)>"0" && ret.charAt(i)<="9")
          return ret;
    return str;
  }
  return str;
}

function compute(obj,val,data)
{
  if (obj[val].value)
  {
    var uval=0;
    uval = obj[val].value*data[val];
    if( (uval >= 0) && (obj[val].value.indexOf("-") != -1) )
    {
      uval = -uval;    // *** Hack for Opera 4.0  2000-10-14
    }
    for (var i in data)
      obj[i].value=normalize(uval/data[i],8);
  }
}


function resetValues(form,data)    
{
    for (var i in data)
      form[i].value="";
}

function resetAll(form)    
{
  resetValues(form,area_data);
  }

//-->
		</SCRIPT>
	</head>
	<body class="bodycolor" topmargin="2">
		<TABLE width="100%" border="0" cellPadding="0" cellSpacing="0" class="small" ID="Table1">
			<TBODY>
				<TR>
					<TD align="center" valign="top">
						<FORM action="" ID="Form1">
							<br>
							<TABLE width="75%" align="center" cellPadding="4" cellSpacing="0" class="small" ID="Table2">
								<TBODY>
									<TR>
										<TD colspan="6">
											可实现平方公里(km<SUP>2</SUP>)、公顷(ha)、市亩、平方米(m<SUP>2</SUP>)、平方分米(dm<SUP>2</SUP>)、平方厘米(cm<SUP>2</SUP>)、平方毫米(mm<SUP>2</SUP>)、平方英里(sq 
											mi)、英亩、平方竿(sq rd)、平方码(sq yd)、平方英尺(sq ft)、平方英寸(sq in)间的互转互换。</TD>
									</TR>
									<TR>
										<TD colspan="6">&nbsp;</TD>
									</TR>
									<TR>
										<TD align="right" noWrap>平方公里(km<SUP>2</SUP>)</TD>
										<TD align="left"><INPUT name="mSquare_kilometer" class="SmallInput" size="15" ID="Text1"></TD>
										<TD align="left"><INPUT onclick="if (checkNum(mSquare_kilometer.value)) compute(this.form,mSquare_kilometer.name,area_data)"
												type="button" value="换算" class='SmallButton' name="mSquare_kilometer_bt" ID="Button1"></TD>
										<TD align="right" noWrap>公顷(ha)</TD>
										<TD align="left"><INPUT name="mHectare" class="SmallInput" size="15" ID="Text2"></TD>
										<TD align="left"><INPUT onclick="if (checkNum(mHectare.value)) compute(this.form,mHectare.name,area_data)"
												type="button" value="换算" class='SmallButton' name="mHectare_bt" ID="Button2"></TD>
									</TR>
									<TR>
										<TD align="right" noWrap>市亩</TD>
										<TD align="left"><INPUT name="mAre" class="SmallInput" size="15" ID="Text3"></TD>
										<TD align="left"><INPUT onclick="if (checkNum(mAre.value)) compute(this.form,mAre.name,area_data)" type="button"
												value="换算" class='SmallButton' name="mAre_bt" ID="Button3"></TD>
										<TD align="right" noWrap>平方米(m<SUP>2</SUP>)</TD>
										<TD align="left"><INPUT name="mSquare_meter" class="SmallInput" size="15" ID="Text4"></TD>
										<TD align="left"><INPUT onclick="if (checkNum(mSquare_meter.value)) compute(this.form,mSquare_meter.name,area_data)"
												type="button" value="换算" class='SmallButton' name="mSquare_meter_bt" ID="Button4"></TD>
									</TR>
									<TR>
										<TD align="right" noWrap>平方分米(dm<SUP>2</SUP>)</TD>
										<TD align="left"><INPUT name="mSquare_decimeter" class="SmallInput" size="15" ID="Text5"></TD>
										<TD align="left"><INPUT onclick="if (checkNum(mSquare_decimeter.value)) compute(this.form,mSquare_decimeter.name,area_data)"
												type="button" value="换算" class='SmallButton' name="mSquare_decimeter_bt" ID="Button5"></TD>
										<TD align="right" noWrap>平方厘米(cm<SUP>2</SUP>)</TD>
										<TD align="left"><INPUT name="mSquare_centimeter" class="SmallInput" size="15" ID="Text6"></TD>
										<TD align="left"><INPUT onclick="if (checkNum(mSquare_centimeter.value)) compute(this.form,mSquare_centimeter.name,area_data)"
												type="button" value="换算" class='SmallButton' name="mSquare_centimeter_bt" ID="Button6"></TD>
									</TR>
									<TR>
										<TD align="right" noWrap>平方毫米(mm<SUP>2</SUP>)</TD>
										<TD align="left"><INPUT name="mSquare_millimeter" class="SmallInput" size="15" ID="Text7"></TD>
										<TD align="left"><INPUT onclick="if (checkNum(mSquare_millimeter.value)) compute(this.form,mSquare_millimeter.name,area_data)"
												type="button" value="换算" class='SmallButton' name="mSquare_millimeter_bt" ID="Button7"></TD>
										<TD align="right" noWrap>平方英里(sq mi)</TD>
										<TD align="left"><INPUT name="engSquare_mile" class="SmallInput" size="15" ID="Text8"></TD>
										<TD align="left"><INPUT onclick="if (checkNum(engSquare_mile.value)) compute(this.form,engSquare_mile.name,area_data)"
												type="button" value="换算" class='SmallButton' name="engSquare_mile_bt" ID="Button8"></TD>
									</TR>
									<TR>
										<TD align="right" noWrap>英亩</TD>
										<TD align="left"><INPUT name="engAcre" class="SmallInput" size="15" ID="Text9"></TD>
										<TD align="left"><INPUT onclick="if (checkNum(engAcre.value)) compute(this.form,engAcre.name,area_data)"
												type="button" value="换算" class='SmallButton' name="engAcre_bt" ID="Button9"></TD>
										<TD align="right" noWrap>平方竿(sq rd)</TD>
										<TD align="left"><INPUT name="usSquare_rod" class="SmallInput" size="15" ID="Text10"></TD>
										<TD align="left"><INPUT onclick="if (checkNum(usSquare_rod.value)) compute(this.form,usSquare_rod.name,area_data)"
												type="button" value="换算" class='SmallButton' name="usSquare_rod_bt" ID="Button10"></TD>
									</TR>
									<TR>
										<TD align="right" noWrap>平方码(sq yd)</TD>
										<TD align="left"><INPUT name="engSquare_yard" class="SmallInput" size="15" ID="Text11"></TD>
										<TD align="left"><INPUT onclick="if (checkNum(engSquare_yard.value)) compute(this.form,engSquare_yard.name,area_data)"
												type="button" value="换算" class='SmallButton' name="engSquare_yard_bt" ID="Button11"></TD>
										<TD align="right" noWrap>平方英尺(sq ft)</TD>
										<TD align="left"><INPUT name="engSquare_foot" class="SmallInput" size="15" ID="Text12"></TD>
										<TD align="left"><INPUT onclick="if (checkNum(engSquare_foot.value)) compute(this.form,engSquare_foot.name,area_data)"
												type="button" value="换算" class='SmallButton' name="engSquare_foot_bt" ID="Button12"></TD>
									</TR>
									<TR>
										<TD align="right" noWrap>平方英寸(sq in)</TD>
										<TD align="left"><INPUT name="engSquare_inch" class="SmallInput" size="15" ID="Text13"></TD>
										<TD align="left"><INPUT onclick="if (checkNum(engSquare_inch.value)) compute(this.form,engSquare_inch.name,area_data)"
												type="button" value="换算" class='SmallButton' name="engSquare_inch_bt" ID="Button13"></TD>
										<TD colSpan="3"></TD>
									</TR>
								</TBODY>
							</TABLE>
							<br>
							<div align="center">
								<INPUT onclick="resetAll(this.form)" type="button" value="数据重置" class='SmallButton' name="res7"
									ID="Button14">
							</div>
						</FORM>
					</TD>
				</TR>
			</TBODY>
		</TABLE>
	</body>
</html>
