<!DOCTYPE html>
<html>
<head>
    <title>分单</title>
    <meta http-equiv="description" content="分单" />
    <meta http-equiv="content-type" content="text/html" />
    <meta charset="UTF-8" />
    <script src="../../../jquery-easyui-1.3.4/jquery.min.js" type="text/javascript"></script>
    <link href="css/common.css?v=201209051438307887" rel="stylesheet" type="text/css" />
    <link href="css/worldofhwa.css?v=201209051438307887" rel="stylesheet" type="text/css" />
    <script src="../../../jquery-easyui-1.3.4/jquery.cookie.js" type="text/javascript"></script>
    <link id="easyuiTheme" href="../../../jquery-easyui-1.3.4/themes/ehras/easyui.css"
        rel="stylesheet" type="text/css" />
    <link href="../../../jquery-easyui-1.3.4/themes/icon.css" rel="stylesheet" type="text/css" />
    <script src="../../../jquery-easyui-1.3.4/jquery.easyui.min.js" type="text/javascript"></script>
    <script src="../../../jquery-easyui-1.3.4/js_hzycfg.js" type="text/javascript"></script>
    <script src="../../../jquery-easyui-1.3.4/js_hzyCommon.js" type="text/javascript"></script>

    <link id="mycss" href="css/hrcss.css" rel="stylesheet" type="text/css" />
</head>
<body style="margin: 0px; width: 99.8%;" id="mybody">
    <div class="pTop">
        <label>店铺管理</label>
        /
        <label>分单申请</label>
        /
        <label></label>
    </div>
    <div style="width: auto; height: 30px;">
        &nbsp;&nbsp;&nbsp;&nbsp;当前分配月份：&nbsp;&nbsp;&nbsp;&nbsp;
        <input id="year" name="year" type="text" style="width: 60px;" />
        &nbsp;&nbsp;年&nbsp;&nbsp
        <input id="month" name="month" type="text" style="width: 60px;" />
        &nbsp;&nbsp;月&nbsp;&nbsp&nbsp;&nbsp;
        <a id="btntj" href="javascript:void(0);" class="easyui-linkbutton" data-options=" plain:true,iconCls:'icon-redo-green'"
            onclick="actApprove()">提交</a>
    </div>
    <div id="fdxx" class="easyui-tabs" style="width: auto; height: auto;">
        <!--奖励分配-->
        <div title="奖励分配" style="padding: 10px">
            <div style="background-color: #fff;">
                <div>
                    <table style="width: 98%; height: 50px;">
                        <tr style="height: 28px;">
                            <td style="width: 180px;">&nbsp;&nbsp;单据所属人： 
                             <input id="shopadminemp" name="shopadminemp" type="text" style="width: 120px;" />
                            </td>
                            <td style="width: 180px;">&nbsp;&nbsp;状态： 
                            <input id="sharestate" name="sharestate" type="text" style="width: 120px;" />
                            </td>
                            <td style="width: 150px;">
                                <a href="javascript:void(0);" class="easyui-linkbutton" data-options=" plain:true,iconCls:'icon-search-black'"
                                    onclick="actShareLoadData(1, m_PageSize)">查询</a>
                                &nbsp;
                                <a href="javascript:void(0);" class="easyui-linkbutton" data-options="plain:true,iconCls:'icon-erase-gray'"
                                    onclick="clearShareText()">清除</a>
                            </td>
                            <td style="width: 70px;"></td>
                        </tr>
                    </table>
                </div>
            </div>
            <table id="jlfplb" class="easyui-datagrid"></table>
            <div id="sharetoolbar" style="padding: 0px; height: auto">
                <div>
                    <a href="javascript:void(0);" class="easyui-linkbutton" data-options=" plain:true,iconCls:'icon-design-green'" onclick="opendlg('share')">分配</a>
                </div>
            </div>
        </div>
        <!--导购金额修改-->
        <div title="导购金额修改" style="padding: 10px">
            <div style="background-color: #fff;">
                <div>
                    <table style="width: 98%; height: 70px;">
                        <tr style="height: 28px;">
                            <td style="width: 70px;">&nbsp;&nbsp;零售单号：</td>
                            <td style="width: 180px;">
                                <input id="retailid" name="retailid" type="text" style="width: 120px;" />
                            </td>
                            <td style="width: 70px;">&nbsp;&nbsp;导购：</td>
                            <td style="width: 180px;">
                                <input id="shopempall" name="shopempall" type="text" style="width: 120px;" />
                            </td>
                            <td style="width: 150px;">
                                <a href="javascript:void(0);" class="easyui-linkbutton" data-options=" plain:true,iconCls:'icon-search-black'"
                                    onclick="actUpdateLoadData(1, m_PageSize)">查询</a>
                                &nbsp;
                                <a href="javascript:void(0);" class="easyui-linkbutton" data-options="plain:true,iconCls:'icon-erase-gray'"
                                    onclick="clearUpdateText()">清除</a>
                            </td>
                            <td style="width: 70px;"></td>
                        </tr>
                        <tr style="height: 28px;">
                            <td style="width: 70px;">&nbsp;&nbsp;查询日期：</td>
                            <td style="width: 180px;">
                                <input id="begindt" name="begindt" type="text" style="width: 120px;" />
                            </td>
                            <td style="width: 70px;">&nbsp;&nbsp;至：</td>
                            <td style="width: 180px;">
                                <input id="enddt" name="enddt" type="text" style="width: 120px;" />
                            </td>
                            <td style="width: 180px;">&nbsp;&nbsp;状态： 
                            <input id="avgsharestate" name="avgsharestate" type="text" style="width: 120px;" />
                            </td>
                            <td style="width: 70px;"></td>
                        </tr>
                    </table>
                </div>
            </div>
            <table id="dgjexglb" class="easyui-datagrid"></table>
            <div id="updatetoolbar" style="padding: 0px; height: auto">
                <div>
                    <a href="javascript:void(0);" class="easyui-linkbutton" data-options=" plain:true,iconCls:'icon-edit-green'" onclick="opendlg('update')">修改</a>
                </div>
            </div>
        </div>
    </div>

    <div id="otherdiv" style="display: none;">
        <!--导购选择-->
        <div id="shopempselect" class="easyui-dialog" title="导购选择" style="width: 400px; height: 280px; padding: 1px"
            data-options="resizable:true,modal:true,top:150" closed="true">
            <div style="">
                <table id="shopemptable" style="margin-left: 5px; margin-top: 5px; margin-right: 5px;"></table>
            </div>
            <div style="width: 99%; text-align: center; height: 40px">
                <br>
                <a id="btnconfirm" href="javascript:void(0);" class="easyui-linkbutton" data-options=" plain:true,iconCls:'icon-redo-green'"
                    onclick="getShopEmp()">确定</a>
            </div>
        </div>
        <!-- 奖励分配明细 -->
        <div id="jlfpdlg" class="easyui-dialog" title="奖励分配明细" style="width: 680px; height: 480px; padding: 1px"
            data-options="resizable:true,modal:true,top:45" closed="true">
            <table id="jlfptable" style="margin-left: 5px; margin-top: 5px; margin-right: 5px; width: 98%">
                <tr style="height: 20px; background-color: #eeeded;">
                    <td colspan="5">&nbsp;&nbsp;&nbsp;销售单信息</td>
                </tr>
                <tr style="height: 40px">
                    <td style="width: 70px">&nbsp;&nbsp;&nbsp;销售单号:</td>
                    <td colspan="4"><span id="retailidgroupspan"></span></td>
                </tr>
                <tr style="height: 40px">
                    <td style="width: 70px">&nbsp;&nbsp;&nbsp;原单销售：</td>
                    <td style="width: 120px"><span id="usernamegroupspan"></span></td>
                    <td style="width: 70px">&nbsp;&nbsp;&nbsp;结算金额：</td>
                    <td style="width: 120px"><span id="samountgroupspan"></span></td>
                    <td style="width: 200px;">
                        <a id="btnsaveshare" href="javascript:void(0);" class="easyui-linkbutton" data-options=" plain:true,iconCls:'icon-save-blue'" onclick="actSave('share')">保存</a>
                    </td>
                </tr>
                <tr style="height: 40px">
                    <td style="width: 70px">&nbsp;&nbsp;&nbsp;实销金额：</td>
                    <td style="width: 120px"><span id="aamountgroupspan"></span></td>
                    <td style="width: 70px">&nbsp;&nbsp;&nbsp;计薪金额：</td>
                    <td style="width: 120px"><span id="pamountgroupspan"></span></td>
                    <td style="width: 200px;">
                        <a id="btnshareemp" href="javascript:void(0);" class="easyui-linkbutton" data-options=" plain:true,iconCls:'icon-status_online'" onclick="opendlg('select')">分配导购</a>
                        &nbsp;
                         <a id="btnshareavg" href="javascript:void(0);" class="easyui-linkbutton" data-options="plain:true,iconCls:'icon-grid-yellow'" onclick="AvgShareList('share')">平均分配</a>
                    </td>
                </tr>
                <tr style="height: 200px">
                    <td colspan="5">
                        <table id="jlfpmxlb"></table>
                    </td>
                </tr>
                <tr style="height: 50px">
                    <td colspan="5">
                        <font color="red">
                            1、按百分比分配，所有导购占比必须等于100%；<br>
                            2、按金额分配，所有导购所占金额总和，必须等于实销金额总和。
                        </font>
                    </td>
                </tr>
            </table>
        </div>
        <!-- 导购金额修改明细 -->
        <div id="dgjexgdlg" class="easyui-dialog" title="导购金额修改明细" style="width: 680px; height: 480px; padding: 1px"
            data-options="resizable:true,modal:true,top:45" closed="true">
            <table id="dgjexgtable" style="margin-left: 5px; margin-top: 5px; margin-right: 5px; width: 98%">
                <tr style="height: 20px; background-color: #eeeded;">
                    <td colspan="5">&nbsp;&nbsp;&nbsp;销售单信息</td>
                </tr>
                <tr style="height: 40px">
                    <td style="width: 70px">&nbsp;&nbsp;&nbsp;销售单号:</td>
                    <td colspan="4"><span id="retailidspan"></span></td>
                </tr>
                <tr style="height: 40px">
                    <td style="width: 70px">&nbsp;&nbsp;&nbsp;原单销售：</td>
                    <td style="width: 120px"><span id="usernamespan"></span></td>
                    <td style="width: 70px">&nbsp;&nbsp;&nbsp;结算金额：</td>
                    <td style="width: 120px"><span id="samountspan"></span></td>
                    <td style="width: 200px;" colspan="4">
                        <a id="btnsaveupdate" href="javascript:void(0);" class="easyui-linkbutton" data-options=" plain:true,iconCls:'icon-save-blue'" onclick="actSave('update')">保存</a>
                    </td>
                </tr>
                <tr style="height: 40px">
                    <td style="width: 70px">&nbsp;&nbsp;&nbsp;实销金额：</td>
                    <td style="width: 120px"><span id="aamountspan"></span></td>
                    <td style="width: 70px">&nbsp;&nbsp;&nbsp;计薪金额：</td>
                    <td style="width: 120px"><span id="pamountspan"></span></td>
                    <td style="width: 200px;">
                        <a id="btnupdateavg" href="javascript:void(0);" class="easyui-linkbutton" data-options="plain:true,iconCls:'icon-grid-yellow'" onclick="AvgShareList('update')">平均分配</a>
                    </td>
                </tr>
                <tr style="height: 200px">
                    <td colspan="5">
                        <table id="dgjexgmxlb"></table>
                    </td>
                </tr>
                <tr style="height: 50px">
                    <td colspan="5">
                        <font color="red">
                            1、按百分比分配，所有导购占比必须等于100%；<br>
                            2、按金额分配，所有导购所占金额总和，必须等于实销金额总和。
                        </font>
                    </td>
                </tr>
            </table>
        </div>
    </div>
</body>
<script type="text/javascript" src="../../../JS/EHRAS/Util/dateUtil.js"></script>
<script type="text/javascript" src="../../../JS/EHRAS/Util/dataUtil.js"></script>
<script type="text/javascript" src="../../../JS/EHRAS/Util/jsonUtil.js"></script>
<script type="text/javascript" src="../../../JS/EHRAS/Util/peoa.js"></script>
<script type="text/javascript" src="../../../JS/EHRAS/HR/basedatahr.js"></script>
<script type="text/javascript" src="../../../JS/EHRAS/HR/page.js"></script>
<script type="text/javascript" src="../../../JS/EHRAS/HR/retailShareList.js"></script>
<script type="text/javascript">
    //处理键盘事件 禁止后退键（Backspace）密码或单行、多行文本框除外
    function forbidBackSpace(e) {
        var ev = e || window.event; //获取event对象 
        var obj = ev.target || ev.srcElement; //获取事件源 
        var t = obj.type || obj.getAttribute('type'); //获取事件源类型 
        var vReadOnly = obj.readOnly;
        var vDisabled = obj.disabled;
        vReadOnly = (vReadOnly == undefined) ? false : vReadOnly;
        vDisabled = (vDisabled == undefined) ? true : vDisabled;
        var flag1 = ev.keyCode == 8 && (t == "password" || t == "text" || t == "textarea") && (vReadOnly == true || vDisabled == true);
        var flag2 = ev.keyCode == 8 && t != "password" && t != "text" && t != "textarea";
        if (flag2 || flag1) return false;
    }
    document.onkeypress = forbidBackSpace;
    document.onkeydown = forbidBackSpace;
</script>
</html>
